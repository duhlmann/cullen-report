<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cullen Commission — 101 Recommendations Tracker</title>
  <style>
    :root{
      --bg:#0b0f19;
      --card:#121827;
      --muted:#9aa4b2;
      --text:#e5e7eb;
      --accent:#6ee7b7;  /* Done (verified) */
      --warn:#facc15;    /* In Progress (verified) */
      --todo:#ef4444;    /* Not Done (verified gap) */
      --unknown:#6b7280; /* Unknown / Unverified */
      --tooltip:#111827; /* tooltip bg */
      --tooltip-text:#e5e7eb;
      --tooltip-shadow: 0 8px 24px rgba(0,0,0,.35);
      --link:#93c5fd;
    }
    html,body{margin:0;background:var(--bg);color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
    h1{margin:0 0 8px}
    p{color:var(--muted);margin:0 0 16px}
    .card{background:var(--card);border-radius:16px;padding:16px;
      box-shadow:0 6px 18px rgba(0,0,0,.2)}
    .legend{display:flex;gap:14px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
    .legend-item{display:flex;align-items:center;gap:6px;color:var(--muted);font-size:14px}
    .swatch{width:14px;height:14px;border-radius:4px;display:inline-block}
    #grid{display:grid;grid-template-columns: repeat(10, 1fr);gap:6px;margin-top:12px}
    .cell{width:30px;height:30px;border-radius:6px;cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-size:10px;font-weight:bold;color:#000;user-select:none;outline:none}
    .cell:focus{box-shadow:0 0 0 2px rgba(255,255,255,.25)}
    .done{background:var(--accent)}
    .progress{background:var(--warn)}
    .todo{background:var(--todo)}
    .unknown{background:var(--unknown);color:#fff}
    .note{color:var(--muted);font-size:12px;margin-top:10px;line-height:1.4}

    /* Custom tooltip */
    .tooltip {
      position: fixed;
      z-index: 9999;
      max-width: min(520px, 92vw);
      background: var(--tooltip);
      color: var(--tooltip-text);
      padding: 10px 12px;
      border-radius: 10px;
      box-shadow: var(--tooltip-shadow);
      font-size: 12px;
      line-height: 1.35;
      display: none; /* hidden by default */
      pointer-events: none;
    }
    .tooltip strong { font-weight:600 }
    .tooltip .status {opacity:.9; font-style: italic; display:block; margin-top:6px}
    .tooltip .sources { margin-top:8px; border-top:1px solid rgba(255,255,255,.08); padding-top:6px }
    .tooltip .sources-title { font-size:11px; opacity:.8; margin-bottom:4px; display:block }
    .tooltip .sources ul { margin:0; padding-left:16px }
    .tooltip a { color: var(--link); text-decoration: underline; word-break: break-word }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Cullen Commission — 101 Recommendations Tracker</h1>
    <p>Hover or focus a box to see the full recommendation text, status, and sources. Gray = not yet verified from public sources.</p>

    <div class="card">
      <div class="legend" aria-hidden="true">
        <div class="legend-item"><span class="swatch" style="background:var(--accent)"></span> Done (verified)</div>
        <div class="legend-item"><span class="swatch" style="background:var(--warn)"></span> In&nbsp;Progress (verified)</div>
        <div class="legend-item"><span class="swatch" style="background:var(--unknown)"></span> Unknown / Unverified</div>
        <div class="legend-item"><span class="swatch" style="background:var(--todo)"></span> Not&nbsp;Done (verified gap)</div>
      </div>

      <div id="grid" role="grid" aria-label="Cullen recommendations grid"></div>
      <div class="note">
        We only color items where we’ve found solid sources (province/federal/LSBC/CPABC). Everything else stays gray until verified.
      </div>
    </div>
  </div>

  <!-- one shared tooltip element -->
  <div id="tooltip" class="tooltip" role="tooltip" aria-hidden="true"></div>

  <script>
    /* --- FULL TEXT OF 101 RECOMMENDATIONS (tooltips) --- */
    const recommendations = [
      "Rec 1: Establish an independent Anti-Money Laundering (AML) Commissioner.",
      "Rec 2: Maintain the Deputy Ministers’ Committee on AML and the AML Secretariat.",
      "Rec 3: Require AML liaison officers across agencies.",
      "Rec 4: Lower casino source-of-funds threshold to $3,000.",
      "Rec 5: Implement 100% account-based known play at casinos.",
      "Rec 6: Maintain limits on casino convenience cheque payouts.",
      "Rec 7: Ensure Independent Gaming Control Office can issue directives.",
      "Rec 8: Include developer employees in real estate licensing.",
      "Rec 9: License large-scale FSBO (‘for sale by owner’) operations.",
      "Rec 10: Support BCFSA data needs, respecting privacy.",
      "Rec 11: Require source-of-funds inquiries by real estate licensees.",
      "Rec 12: Brokerages must have AML compliance programs.",
      "Rec 13: Resource BCFSA to handle serious misconduct quickly.",
      "Rec 14: Harmonize mortgage broker definition with registration.",
      "Rec 15: Extended criminal/police checks for mortgage brokers.",
      "Rec 16: Require mortgage brokerages to submit annual info returns.",
      "Rec 17: Give BCFSA rule-making authority over mortgage brokers.",
      "Rec 18: Create managing broker role with defined responsibilities.",
      "Rec 19: Mandatory AML training for mortgage brokers/managers.",
      "Rec 20: Raise penalties under Mortgage Brokers Act to $250k.",
      "Rec 21: Registrar can order profit disgorgement incl. unregistered actors.",
      "Rec 22: Licensees must report unregistered mortgage brokering.",
      "Rec 23: Remove automatic stay pending appeal in Act.",
      "Rec 24: BCFSA partnerships with AML intel/investigation unit.",
      "Rec 25: Ask feds to make mortgage brokers reporting entities.",
      "Rec 26: Private mortgage lenders must inquire into source of investor capital.",
      "Rec 27: Modify Form B to report all legal mortgage owners.",
      "Rec 28: Amend LOTR to include mortgages as interests in land.",
      "Rec 29: Regulate private mortgage lenders under new legislation.",
      "Rec 30: Regulator access to land title data to find unregistered lenders.",
      "Rec 31: Mandatory source-of-funds in foreclosure petitions.",
      "Rec 32: Courts may deny relief if source funds false/suspect.",
      "Rec 33: Remove fees for LOTR access by law enforcement.",
      "Rec 34: AML Commissioner to review LOTR after 3 years.",
      "Rec 35: Finance/CMHC to analyze real estate data integrity.",
      "Rec 36: Give LTSA explicit AML mandate.",
      "Rec 37: Give Real Estate Data Analytics Unit explicit AML mandate.",
      "Rec 38: Develop action plan to close real estate data gaps.",
      "Rec 39: Hybrid model of data management; AML Commissioner analyzes.",
      "Rec 40: LTSA must provide historical mortgage/property info.",
      "Rec 41: Amend LTSA to record agents/brokers in transactions.",
      "Rec 42: Use unique identifiers for LTSA records.",
      "Rec 43: Remove fees for LTSA access by AML/law enforcement.",
      "Rec 44: Analyze housing price impacts of reforms.",
      "Rec 45: BCFSA to develop AML guidance for credit unions.",
      "Rec 46: Give BCFSA enduring AML mandate.",
      "Rec 47: Resource BCFSA to create AML contact group.",
      "Rec 48: Urge feds to amend PIPEDA safe-harbour for FI info sharing.",
      "Rec 49: Create provincial safe-harbour for FI info sharing.",
      "Rec 50: Create ‘keep open’ regime for suspicious accounts.",
      "Rec 51: Expand BCFSA mandate to regulate MSBs.",
      "Rec 52: Work with partners to implement pan-Canadian ownership registry.",
      "Rec 53: Law Societies to develop AML metrics (breaches, referrals).",
      "Rec 54: Law Societies to build info-sharing and coordination systems.",
      "Rec 55: Amend LS Rule 3-59 cash exception to reasonable fees only.",
      "Rec 56: Clarify LS client ID rules on source of money.",
      "Rec 57: Expand LS ID/verification to more contexts.",
      "Rec 58: Clarify ‘directly related to legal services’ in LS trust account rule.",
      "Rec 59: LS to raise awareness on trust account limitations & info sharing.",
      "Rec 60: Remove Commentary 3.1(a) from LS Code.",
      "Rec 61: AML training for LS trust auditors/investigators.",
      "Rec 62: Mandatory AML training for high-risk lawyers.",
      "Rec 63: Police must refer lawyer cases to LS; LS to advocate for rules.",
      "Rec 64: LS to clarify process for giving evidence to law enforcement.",
      "Rec 65: Province+LS to raise awareness on lawyer oversight.",
      "Rec 66: Raise max fines for Notaries Public misconduct.",
      "Rec 67: Notaries must record source of funds in transactions.",
      "Rec 68: AML education for notaries on private lending.",
      "Rec 69: CPABC Code: members must report FINTRAC non-compliance.",
      "Rec 70: Study unregulated accountants and ML risk.",
      "Rec 71: Ask feds to add accountants as reporting entities.",
      "Rec 72: CPABC to require ID/verification & source-funds rules.",
      "Rec 73: CPABC to assess use of trust accounts.",
      "Rec 74: Audit unreported or sampled accountants’ trust accounts.",
      "Rec 75: CPABC to investigate member cash acceptance.",
      "Rec 76: Implement cash limits for accountants in client matters.",
      "Rec 77: CPABC to track member activities under PCMLTFA regs.",
      "Rec 78: Add AML compliance to practice reviews.",
      "Rec 79: AML continuing education for high-risk accountants.",
      "Rec 80: CPABC continuous liaison with FINTRAC.",
      "Rec 81: CPABC to enable law enforcement info sharing.",
      "Rec 82: Universal record-keeping/reporting for $10k+ luxury goods.",
      "Rec 83: Minister+AML Commissioner can impose measures in luxury sector.",
      "Rec 84: Regulate vehicle exports; registration & reporting.",
      "Rec 85: Amend PST Act for vehicle tax rebate info sharing.",
      "Rec 86: Train law enforcement/regulators on virtual assets.",
      "Rec 87: Create regulatory regime for VASPs.",
      "Rec 88: Use trade-based ML detection software in intel unit.",
      "Rec 89: Police must consider ML at start of profit crime cases.",
      "Rec 90: ML training modules for law enforcement (asset seizure).",
      "Rec 91: Create dedicated provincial ML intel & investigation unit.",
      "Rec 92: AML Commissioner+Branch to monitor RCMP allocation, outcomes.",
      "Rec 93: Branch to track FINTRAC responses to info records.",
      "Rec 94: Ensure CFSEU has enough surveillance to support intel unit.",
      "Rec 95: AML Commissioner to review intel unit every 5 years.",
      "Rec 96: Police must consider asset forfeiture in profit crime cases.",
      "Rec 97: Include asset forfeiture recs in Crown reports.",
      "Rec 98: Training on criminal forfeiture for investigators/prosecutors.",
      "Rec 99: Expand Civil Forfeiture Office staff capacity.",
      "Rec 100: Move Civil Forfeiture Office to gov’t funding model.",
      "Rec 101: Develop unexplained wealth order regime in BC."
    ];

    /* --- VERIFIED STATUS LOOKUP (we color only what we can back up) --- */
    const statusByRec = {
      // Corporate / beneficial ownership
      52: "progress",

      // Real estate / LOTR / Mortgages (MSA + federal coverage)
      33: "done",
      25: "done",
      14: "progress",
      15: "progress",
      16: "progress",
      17: "progress",
      18: "progress",
      19: "progress",
      20: "progress",
      22: "progress",
      23: "progress",
      26: "progress",
      29: "progress",

      // Gambling
      5:  "progress",
      4:  "todo",

      // Financial sector
      51: "progress",
      85: "done",

      // Public safety / coordination
      91: "done",
      63: "progress",
      64: "progress",
      65: "progress",

      // Professions (lawyers/notaries/accountants)
      55: "progress",
      56: "progress",
      58: "progress",
      62: "progress",
      66: "progress",
      67: "progress",
      68: "progress",
      69: "done",
      70: "progress",
      71: "done",
      72: "done",
      73: "progress",
      74: "progress",
      75: "progress",
      76: "unknown",
      77: "progress",
      78: "done",
      79: "progress",
      80: "progress",
      81: "progress",

      // Luxury goods (conservative)
      82: "unknown",
      83: "unknown",
      84: "unknown",

      // Virtual assets / TBML (conservative)
      86: "unknown",
      87: "unknown",
      88: "unknown",

      // Law enforcement & forfeiture
      89: "done",
      90: "progress",
      92: "unknown",
      93: "unknown",
      94: "progress",
      95: "unknown",
      96: "done",
      97: "unknown",
      98: "progress",
      99: "progress",
      100:"done",

      // Civil forfeiture capstone
      101:"done"
    };

    /* --- SOURCES PER RECOMMENDATION ---
       Put one or more strings per rec. You can include titles and/or URLs.
       Examples below use plain text (safe). If you want clickable links,
       include full URLs; the tooltip will auto-link them.
    */
    const sourcesByRec = {
      33: [
        "BC Gov – Quick Glance: Real Estate (LOTR fees removed)"
      ],
      25: [
  "BC Gov – Real Estate: mortgage brokers/lenders under PCMLTFA (Oct 2024) https://www2.gov.bc.ca/gov/content/justice/anti-money-laundering/quick-glance-government-actions/real-estate"
],
      14: ["BCFSA – Mortgage Services Act (in force Oct 13, 2026)"],
      15: ["BCFSA – MSA suitability/background checks"],
      16: ["BCFSA – MSA reporting/returns framework"],
      17: ["BCFSA – MSA rule-making authority"],
      18: ["BCFSA – MSA managing/principal broker role"],
      19: ["BCFSA – MSA competency/education requirements"],
      20: ["BCFSA – MSA penalties"],
      22: ["BCFSA – MSA unregistered brokering enforcement"],
      23: ["BCFSA – MSA appeals/discipline modernization"],
      26: ["BC Gov – Real Estate: PCMLTFA coverage imposes source-of-funds duties"],
      29: ["BCFSA – MSA licensing for private mortgage lenders"],

      5:  ["BC Gov – Gambling: known-play roadmap to 2029; ID at entry"],
      4:  ["BC Gov – Gambling: SOF threshold still $10,000 (Cullen asked $3,000)"],

      51: ["BC Gov – Financial Sector: MSB Act introduced (in force by regulation)"],
      85: ["BC Gov – Financial Sector: PST export-vehicle refund loophole closed"],

      91: ["BC Gov – Public Safety: Superintendence & Evaluation Unit created"],
      63: ["BC Gov – Public Safety: LSBC referrals strengthened"],
      64: ["BC Gov – Public Safety: LSBC evidence-sharing process"],
      65: ["BC Gov – Public Safety: public awareness on oversight"],

      55: ["LSBC – Rule 3-59 cash exception revision process"],
      56: ["LSBC – Client ID/source-of-money guidance updates"],
      58: ["LSBC – Advisory clarifying Rule 3-58.1 (‘directly related’)"],
      62: ["LSBC – Tabled AML training for high-risk lawyers"],

      66: ["BC Gov – Lawyers/Notaries: Legal Professions Act (notaries’ fines to $250k)"],
      67: ["FINTRAC/BC Notaries – SOF documentation obligations"],
      68: ["BC Notaries – AML training offerings"],

      69: ["CPABC Code – Rule on reporting FINTRAC non-compliance"],
      70: ["BC Gov – Professions: sector analysis of non-CPABC financial pros"],
      71: ["PCMLTFA – accountants as reporting entities"],
      72: ["CPABC Rule 219 – Client ID/verification & SOF"],
      73: ["CPABC Practice Review – trust account usage reviews"],
      74: ["CPABC Practice Review – sampling (incl. trust accounts)"],
      75: ["CPABC Discipline/Review – cash acceptance oversight"],
      77: ["CPABC – declarations re: PCMLTFA-regulated activities"],
      78: ["CPABC Practice Review – AML compliance integrated"],
      79: ["CPABC – AML professional development programs"],
      80: ["CPABC – liaison with FINTRAC"],
      81: ["CPABC – cooperation with law enforcement"],

      89: ["BC Gov – Public Safety: police to consider ML at outset"],
      90: ["BC Gov – Public Safety: ML/asset-seizure training modules"],
      94: ["BC Gov – Public Safety: CFSEU resourcing"],
      96: ["BC Gov – Public Safety: police to consider civil forfeiture"],
      98: ["BC Gov – Public Safety: criminal forfeiture training"],
      99: ["BC Gov – Public Safety/Civil Forfeiture: CFO capacity expanded"],
      100:["BC Gov – Public Safety: CFO on government budget model"],
      101:["BC Gov – Civil Forfeiture: Unexplained Wealth Orders enacted/used"],

      52: ["BC Gov – Corporate ownership transparency; federal registry note"],

      // Unknown items intentionally have no sources; tooltip will say “not yet verified”.
    };

    /* --- BUILD GRID + TOOLTIP --- */
    const grid = document.getElementById('grid');
    const tooltip = document.getElementById('tooltip');

    function autoLink(text){
      // turns bare URLs into <a href="...">...</a>
      const urlRegex = /(https?:\/\/[^\s)]+)|((?:www\.)[^\s)]+)/gi;
      return text.replace(urlRegex, (m) => {
        const url = m.startsWith('http') ? m : `https://${m}`;
        return `<a href="${url}" target="_blank" rel="noopener noreferrer">${m}</a>`;
      });
    }

    function showTooltip(target, html) {
      tooltip.innerHTML = html;
      tooltip.style.display = 'block';
      tooltip.setAttribute('aria-hidden', 'false');

      const rect = target.getBoundingClientRect();
      const padding = 8;
      const ttRect = tooltip.getBoundingClientRect();

      let top = rect.top - ttRect.height - padding;
      if (top < 8) top = rect.bottom + padding;

      let left = rect.left + (rect.width - ttRect.width)/2;
      left = Math.max(8, Math.min(left, window.innerWidth - ttRect.width - 8));

      tooltip.style.top = `${top + window.scrollY}px`;
      tooltip.style.left = `${left + window.scrollX}px`;
    }
    function hideTooltip(){
      tooltip.style.display = 'none';
      tooltip.setAttribute('aria-hidden','true');
      tooltip.innerHTML = '';
    }

    for (let n = 1; n <= 101; n++) {
      const status = statusByRec[n] || "unknown";
      const cell = document.createElement('div');
      cell.className = `cell ${status}`;
      cell.textContent = n;
      cell.setAttribute('role','gridcell');
      cell.setAttribute('tabindex','0');
      cell.setAttribute('aria-label', `Recommendation ${n}`);

      const label =
        status === 'done' ? 'Done (verified)' :
        status === 'progress' ? 'In Progress (verified)' :
        status === 'todo' ? 'Not Done (verified gap)' :
        'Unknown / Unverified';

      const recText = recommendations[n-1] || `Recommendation ${n}`;

      // Build sources list for this rec, if any
      const src = sourcesByRec[n];
      let sourcesHTML = '';
      if (status === 'unknown' || !src || src.length === 0) {
        sourcesHTML = `<div class="sources"><span class="sources-title">Source</span><ul><li>Not yet verified</li></ul></div>`;
      } else {
        const items = src.map(s => `<li>${autoLink(s)}</li>`).join('');
        sourcesHTML = `<div class="sources"><span class="sources-title">Sources</span><ul>${items}</ul></div>`;
      }

      const tipHTML = `<strong>${recText}</strong><span class="status">Status: ${label}</span>${sourcesHTML}`;

      // mouse
      cell.addEventListener('mouseenter', () => showTooltip(cell, tipHTML));
      cell.addEventListener('mouseleave', hideTooltip);
      // keyboard
      cell.addEventListener('focus', () => showTooltip(cell, tipHTML));
      cell.addEventListener('blur', hideTooltip);
      // touch (tap to show; tap elsewhere to hide)
      cell.addEventListener('touchstart', (e) => {
        e.preventDefault();
        showTooltip(cell, tipHTML);
      }, {passive:false});

      grid.appendChild(cell);
    }

    // close tooltip on scroll/resize/escape/tap outside
    window.addEventListener('scroll', hideTooltip, {passive:true});
    window.addEventListener('resize', hideTooltip);
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape') hideTooltip(); });
    document.addEventListener('touchstart', (e) => {
      if (!e.target.closest('.cell')) hideTooltip();
    }, {passive:true});
  </script>
</body>
</html>
